
<%= render 'user/posts/nav' %>

<hr>

<h2>投稿ページ</h2>

<% if @post.errors.any? %>
  <%= @post.errors.count %>error!
  <% @post.errors.full_messages.each do |message| %>
    <%= message %>
  <% end %>
<% end %>


<%= form_for(@post, url:user_posts_path ,method: :post) do |f| %>

	<div>
	  <% if @post.errors.any? %>
	    <div id="error_explanation">
	      <h2><%= @post.errors.count %>件のエラーが発生しました。</h2>
	      <ul>
	      <% @post.errors.full_messages.each do |message| %>
	        <li><%= message %></li>
	      <% end %>
	      </ul>
	    </div>
	  <% end %>
	</div>

	<div>
		<label>投稿画像</label>
		<br>
		<img id="preview" width="250" height="200">
		<%= f.file_field :post_image, id:"myImage" %>
	    <br>
	</div>

	<div>
		<label>目標</label>
		<br>
		<% current_user.targets.each do |u| %>
			<%= f.radio_button :post_target, u.target_body %>
			<%= u.target_body %>
			<br>
		<% end %>
	</div>

	<div>
		<label>つぶやき</label>
		<br>
		<%= f.text_area :post_body %>
	</div>

	<hr>
	<%= f.submit "投稿する" %>
<% end %>


<script>
	$('#myImage').on('change', function (e) {
    var reader = new FileReader();
    reader.onload = function (e) {
        $("#preview").attr('src', e.target.result);
    }
    reader.readAsDataURL(e.target.files[0]);
	});
</script>